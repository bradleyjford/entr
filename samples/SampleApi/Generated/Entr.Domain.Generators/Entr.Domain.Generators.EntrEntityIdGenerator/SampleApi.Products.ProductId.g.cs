//------------------------------------------------------------------------------
// <auto-generated>
//     This code was generated by the EntrEntityId source generator
//
//     Changes to this file may cause incorrect behavior and will be lost if
//     the code is regenerated.
// </auto-generated>
//------------------------------------------------------------------------------

#pragma warning disable 1591 // publicly visible type or member must be documented

using System;
using System.ComponentModel;
using System.Globalization;
using System.Text.Json;
using System.Text.Json.Serialization;
using Entr.Domain;

namespace SampleApi.Products;

[JsonConverter(typeof(ProductIdJsonConverter))]
[TypeConverter(typeof(ProductIdTypeConverter))]
readonly partial struct ProductId : IEquatable<ProductId>
{
    public static ProductId New()
        => new ProductId(SequentialGuidGenerator.Generate());

    public ProductId(System.Guid value)
    {
        if (value == default)
        {
            throw new ArgumentException("Specified value cannot be default(System.Guid)", nameof(value));
        }

        Value = value;
    }

    public System.Guid Value { get; }

    public override int GetHashCode()
    {
        return HashCode.Combine(typeof(ProductId), Value);
    }

    public override string ToString() => Value.ToString();

    public override bool Equals(object obj)
        => obj is ProductId other && Equals(this, other);
    public bool Equals(ProductId other)
        => Equals(this, other);

    public static bool Equals(ProductId? left, ProductId? right)
    {
        if (!left.HasValue && !right.HasValue) return true;
        if (!left.HasValue || !right.HasValue) return false;

        return left.Value.Value == right.Value.Value;
    }

    public static bool operator ==(ProductId left, ProductId right) =>
        Equals(left, right);
    public static bool operator !=(ProductId left, ProductId right) =>
        !Equals(left, right);

    public sealed class ProductIdJsonConverter : JsonConverter<ProductId>
    {
        public override ProductId Read(ref Utf8JsonReader reader, Type typeToConvert, JsonSerializerOptions options)
           => new ProductId(reader.GetGuid()!);

        public override void Write(Utf8JsonWriter writer, ProductId id, JsonSerializerOptions options)
           => writer.WriteStringValue(id.Value);
      }

    public sealed class ProductIdTypeConverter : TypeConverter
    {
        public override bool CanConvertFrom(ITypeDescriptorContext context, Type sourceType)
            => sourceType == typeof(System.Guid) || sourceType == typeof(string);
        public override bool CanConvertTo(ITypeDescriptorContext context, Type destinationType)
            => destinationType == typeof(System.Guid) || destinationType == typeof(string);

        public override object ConvertFrom(ITypeDescriptorContext context, CultureInfo culture, object value)
        {
            if (value.GetType() == typeof(string))
            {
                return new ProductId(System.Guid.Parse((string)value));
            }

            return new ProductId((System.Guid)value);
        }

        public override object ConvertTo(ITypeDescriptorContext context, CultureInfo culture, object value, Type destinationType)
        {
            if (destinationType == typeof(string))
            {
                return ((ProductId)value).Value.ToString();
            }

            return ((ProductId)value).Value;
        }
    }
}
